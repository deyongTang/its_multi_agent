# Agent-as-Tool è®¾è®¡æ¨¡å¼

> å°†å¤æ‚çš„æ™ºèƒ½ä½“å°è£…ä¸ºç®€å•çš„å‡½æ•°å·¥å…·ï¼Œå®ç°å¤šæ™ºèƒ½ä½“ç³»ç»Ÿçš„ä¼˜é›…åä½œ

## ç›®å½•

- [1. é—®é¢˜èƒŒæ™¯](#1-é—®é¢˜èƒŒæ™¯)
- [2. è®¾è®¡æ¨¡å¼æ¦‚è¿°](#2-è®¾è®¡æ¨¡å¼æ¦‚è¿°)
- [3. æ ¸å¿ƒå®ç°](#3-æ ¸å¿ƒå®ç°)
- [4. è®¾è®¡ä¼˜åŠ¿](#4-è®¾è®¡ä¼˜åŠ¿)
- [5. å®æˆ˜æ¡ˆä¾‹](#5-å®æˆ˜æ¡ˆä¾‹)
- [6. æœ€ä½³å®è·µ](#6-æœ€ä½³å®è·µ)
- [7. å¸¸è§é™·é˜±](#7-å¸¸è§é™·é˜±)

---

## 1. é—®é¢˜èƒŒæ™¯

### 1.1 å¤šæ™ºèƒ½ä½“ç³»ç»Ÿçš„æŒ‘æˆ˜

åœ¨æ„å»ºå¤šæ™ºèƒ½ä½“ç³»ç»Ÿæ—¶ï¼Œæˆ‘ä»¬é¢ä¸´ä»¥ä¸‹æ ¸å¿ƒé—®é¢˜ï¼š

**é—®é¢˜ 1ï¼šè°ƒåº¦å¤æ‚æ€§**
```python
# âŒ ä¸å¥½çš„åšæ³•ï¼šè°ƒåº¦å™¨ç›´æ¥ç®¡ç† Agent å¯¹è±¡
class Orchestrator:
    def __init__(self):
        self.technical_agent = TechnicalAgent()
        self.service_agent = ServiceAgent()

    async def route(self, query: str):
        if "ç»´ä¿®" in query:
            runner = Runner()
            config = RunConfig(...)
            result = await runner.run(self.technical_agent, input=query, config=config)
            return result.final_output
        elif "å¯¼èˆª" in query:
            runner = Runner()
            config = RunConfig(...)
            result = await runner.run(self.service_agent, input=query, config=config)
            return result.final_output
```

**é—®é¢˜æ¸…å•**ï¼š
- ğŸ”´ è°ƒåº¦å™¨éœ€è¦äº†è§£æ¯ä¸ª Agent çš„å®ç°ç»†èŠ‚
- ğŸ”´ é‡å¤çš„ Runner åˆ›å»ºå’Œé…ç½®ä»£ç 
- ğŸ”´ é”™è¯¯å¤„ç†é€»è¾‘åˆ†æ•£
- ğŸ”´ éš¾ä»¥æµ‹è¯•å’Œæ‰©å±•
- ğŸ”´ è¿åå•ä¸€èŒè´£åŸåˆ™

### 1.2 ç†æƒ³çš„è°ƒåº¦æ¨¡å‹

æˆ‘ä»¬å¸Œæœ›è°ƒåº¦å™¨èƒ½å¤Ÿï¼š
- âœ… åƒè°ƒç”¨æ™®é€šå‡½æ•°ä¸€æ ·è°ƒç”¨ Agent
- âœ… ä¸å…³å¿ƒ Agent çš„å†…éƒ¨å®ç°
- âœ… ç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- âœ… æ˜“äºæµ‹è¯•å’Œæ‰©å±•

---

## 2. è®¾è®¡æ¨¡å¼æ¦‚è¿°

### 2.1 æ ¸å¿ƒæ€æƒ³

**Agent-as-Tool** æ¨¡å¼å°†æ™ºèƒ½ä½“ï¼ˆAgentï¼‰åŒ…è£…æˆå‡½æ•°å·¥å…·ï¼ˆFunction Toolï¼‰ï¼Œä½¿å…¶å¯ä»¥è¢«å…¶ä»– Agent åƒè°ƒç”¨æ™®é€šå‡½æ•°ä¸€æ ·è°ƒç”¨ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    è°ƒåº¦å™¨ (Orchestrator)                 â”‚
â”‚  "æˆ‘åªçŸ¥é“æœ‰å“ªäº›å·¥å…·ï¼Œä¸å…³å¿ƒå·¥å…·å†…éƒ¨æ˜¯ä»€ä¹ˆ"              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ è°ƒç”¨å·¥å…·
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Agent-as-Tool é€‚é…å™¨å±‚                      â”‚
â”‚  @function_tool                                          â”‚
â”‚  async def consult_technical_expert(query: str) -> str   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ å†…éƒ¨å¯åŠ¨ Runner
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 æŠ€æœ¯ä¸“å®¶ Agent                           â”‚
â”‚  (å¤æ‚çš„ Agent å¯¹è±¡ï¼Œæœ‰è‡ªå·±çš„å·¥å…·å’Œé€»è¾‘)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 è®¾è®¡æ¨¡å¼åˆ†ç±»

è¿™æ˜¯ä¸€ä¸ª**é€‚é…å™¨æ¨¡å¼ï¼ˆAdapter Patternï¼‰**çš„å˜ä½“ï¼š
- **ç›®æ ‡æ¥å£**: ç®€å•çš„å‡½æ•°å·¥å…· `(query: str) -> str`
- **è¢«é€‚é…è€…**: å¤æ‚çš„ Agent å¯¹è±¡
- **é€‚é…å™¨**: `@function_tool` è£…é¥°çš„åŒ…è£…å‡½æ•°

---

## 3. æ ¸å¿ƒå®ç°

### 3.1 åŸºç¡€ç»“æ„

```python
from agents import function_tool, Runner
from agents.run import RunConfig

# 1. å®šä¹‰ä¸‹æ¸¸ Agentï¼ˆè¢«åŒ…è£…çš„å¯¹è±¡ï¼‰
technical_agent = Agent(
    name="æŠ€æœ¯ä¸“å®¶",
    instructions="ä½ æ˜¯ä¸€ä¸ªæŠ€æœ¯ç»´ä¿®ä¸“å®¶...",
    tools=[query_knowledge, web_search]
)

# 2. å°† Agent åŒ…è£…ä¸º Tool
@function_tool
async def consult_technical_expert(query: str) -> str:
    """
    ã€å’¨è¯¢æŠ€æœ¯ä¸“å®¶ã€‘å¤„ç†æŠ€æœ¯å’¨è¯¢ã€è®¾å¤‡æ•…éšœã€ç»´ä¿®å»ºè®®ã€‚

    Args:
        query: ç”¨æˆ·çš„åŸå§‹é—®é¢˜æˆ–å®Œæ•´æŒ‡ä»¤

    Returns:
        æŠ€æœ¯ä¸“å®¶çš„å›ç­”
    """
    try:
        # å¯åŠ¨ Runner æ‰§è¡Œ Agent
        result = await Runner.run(
            technical_agent,
            input=query,
            run_config=RunConfig(tracing_disabled=True)
        )
        return result.final_output
    except Exception as e:
        return f"æŠ€æœ¯ä¸“å®¶æš‚æ—¶æ— æ³•å›ç­”: {str(e)}"

# 3. å¯¼å‡ºå·¥å…·åˆ—è¡¨
AGENT_TOOLS = [consult_technical_expert]
```

### 3.2 è°ƒåº¦å™¨ä½¿ç”¨

```python
# è°ƒåº¦å™¨åªéœ€æ³¨å†Œå·¥å…·ï¼Œæ— éœ€äº†è§£å®ç°ç»†èŠ‚
orchestrator = Agent(
    name="è°ƒåº¦å™¨",
    instructions="""
    ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½è°ƒåº¦å™¨ã€‚
    - æŠ€æœ¯é—®é¢˜ â†’ è°ƒç”¨ consult_technical_expert
    - æœåŠ¡ç«™æŸ¥è¯¢ â†’ è°ƒç”¨ query_service_station_and_navigate
    """,
    tools=AGENT_TOOLS  # æ³¨å†ŒåŒ…è£…åçš„å·¥å…·
)
```

---

## 4. è®¾è®¡ä¼˜åŠ¿

### 4.1 è§£è€¦ä¸å°è£…

**å¯¹æ¯”è¡¨**ï¼š

| ç»´åº¦ | ç›´æ¥è°ƒç”¨ Agent | Agent-as-Tool |
|------|---------------|---------------|
| **è°ƒåº¦å™¨èŒè´£** | ç®¡ç† Agent å¯¹è±¡ã€é…ç½® Runner | åªè´Ÿè´£æ„å›¾è¯†åˆ«å’Œå·¥å…·é€‰æ‹© |
| **ä»£ç è€¦åˆåº¦** | é«˜ï¼ˆéœ€è¦å¯¼å…¥æ‰€æœ‰ Agent ç±»ï¼‰ | ä½ï¼ˆåªå¯¼å…¥å·¥å…·å‡½æ•°ï¼‰ |
| **ä¿®æ”¹å½±å“èŒƒå›´** | Agent æ”¹åŠ¨å½±å“è°ƒåº¦å™¨ | Agent æ”¹åŠ¨ä¸å½±å“è°ƒåº¦å™¨ |
| **æµ‹è¯•éš¾åº¦** | éœ€è¦ Mock æ•´ä¸ª Agent ç³»ç»Ÿ | å¯ä»¥ç‹¬ç«‹æµ‹è¯•æ¯ä¸ªå·¥å…· |

### 4.2 ç»Ÿä¸€çš„æ¥å£å¥‘çº¦

æ‰€æœ‰ Agent å·¥å…·éƒ½éµå¾ªç›¸åŒçš„ç­¾åï¼š

```python
async def tool_name(query: str) -> str:
    """å·¥å…·æè¿°ï¼ˆä¼šè¢« LLM è¯»å–ï¼‰"""
    pass
```

**å¥½å¤„**ï¼š
- âœ… LLM å®¹æ˜“ç†è§£å·¥å…·ç”¨é€”
- âœ… è°ƒç”¨æ–¹å¼ä¸€è‡´ï¼Œé™ä½è®¤çŸ¥è´Ÿæ‹…
- âœ… æ˜“äºç¼–å†™å•å…ƒæµ‹è¯•

### 4.3 é›†ä¸­çš„é”™è¯¯å¤„ç†

```python
@function_tool
async def consult_technical_expert(query: str) -> str:
    try:
        # æ ¸å¿ƒé€»è¾‘
        result = await Runner.run(...)
        return result.final_output
    except Exception as e:
        # ç»Ÿä¸€çš„é”™è¯¯å¤„ç†
        logger.error(f"æŠ€æœ¯ä¸“å®¶è°ƒç”¨å¤±è´¥: {str(e)}")
        return f"æŠ€æœ¯ä¸“å®¶æš‚æ—¶æ— æ³•å›ç­”: {str(e)}"
```

**ä¼˜åŠ¿**ï¼š
- ğŸ›¡ï¸ é˜²æ­¢å•ä¸ª Agent å´©æºƒå¯¼è‡´æ•´ä¸ªç³»ç»Ÿå´©æºƒ
- ğŸ“Š ç»Ÿä¸€çš„æ—¥å¿—æ ¼å¼ï¼Œä¾¿äºç›‘æ§
- ğŸ”„ å¯ä»¥åœ¨æ­¤å¤„æ·»åŠ é‡è¯•é€»è¾‘

### 4.4 å¯æ‰©å±•æ€§

æ·»åŠ æ–° Agent åªéœ€ä¸‰æ­¥ï¼š

```python
# æ­¥éª¤ 1: å®šä¹‰æ–° Agent
new_agent = Agent(name="æ–°ä¸“å®¶", instructions="...", tools=[...])

# æ­¥éª¤ 2: åŒ…è£…ä¸ºå·¥å…·
@function_tool
async def consult_new_expert(query: str) -> str:
    result = await Runner.run(new_agent, input=query, ...)
    return result.final_output

# æ­¥éª¤ 3: æ·»åŠ åˆ°å·¥å…·åˆ—è¡¨
AGENT_TOOLS.append(consult_new_expert)
```

**æ— éœ€ä¿®æ”¹è°ƒåº¦å™¨ä»£ç ï¼**

---

## 5. å®æˆ˜æ¡ˆä¾‹

### 5.1 ITS å¤šæ™ºèƒ½ä½“ç³»ç»Ÿæ¶æ„

åœ¨ ITS æ™ºèƒ½å®¢æœç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨æ­¤æ¨¡å¼å®ç°äº†ä¸‰å±‚æ¶æ„ï¼š

```
ç”¨æˆ·è¯·æ±‚
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è°ƒåº¦å™¨ (Orchestrator)               â”‚
â”‚  - æ„å›¾è¯†åˆ«                          â”‚
â”‚  - å·¥å…·é€‰æ‹©                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æŠ€æœ¯ä¸“å®¶å·¥å…·  â”‚   â”‚ æœåŠ¡ç«™ä¸“å®¶å·¥å…·    â”‚
â”‚ (Tool å±‚)    â”‚   â”‚ (Tool å±‚)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æŠ€æœ¯ä¸“å®¶ Agentâ”‚   â”‚ æœåŠ¡ç«™ Agent     â”‚
â”‚ (Agent å±‚)   â”‚   â”‚ (Agent å±‚)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ çŸ¥è¯†åº“ã€æœç´¢  â”‚   â”‚ MySQLã€åœ°å›¾ API  â”‚
â”‚ (Tool å±‚)    â”‚   â”‚ (Tool å±‚)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 å®Œæ•´ä»£ç ç¤ºä¾‹

**æ–‡ä»¶ï¼š`multi_agent/agent_factory.py`**

```python
from agents import function_tool, Runner
from agents.run import RunConfig
from multi_agent.technical_agent import technical_agent
from multi_agent.service_agent import comprehensive_service_agent
from infrastructure.logging.logger import logger

# ============================================================
# å·¥å…· 1: æŠ€æœ¯ä¸“å®¶
# ============================================================
@function_tool
async def consult_technical_expert(query: str) -> str:
    """
    ã€å’¨è¯¢æŠ€æœ¯ä¸“å®¶ã€‘å¤„ç†æŠ€æœ¯å’¨è¯¢ã€è®¾å¤‡æ•…éšœã€ç»´ä¿®å»ºè®®ä»¥åŠå®æ—¶èµ„è®¯ã€‚

    é€‚ç”¨åœºæ™¯ï¼š
    1. "æ€ä¹ˆä¿®"ã€"ä¸ºä»€ä¹ˆåäº†"ã€"å¦‚ä½•æ“ä½œ"ç­‰æŠ€æœ¯é—®é¢˜
    2. "ä»Šå¤©è‚¡ä»·"ã€"ç°åœ¨å¤©æ°”"ç­‰å®æ—¶ä¿¡æ¯

    Args:
        query: ç”¨æˆ·çš„åŸå§‹é—®é¢˜æˆ–å®Œæ•´æŒ‡ä»¤

    Returns:
        æŠ€æœ¯ä¸“å®¶çš„è¯¦ç»†å›ç­”
    """
    try:
        logger.info(f"[Route] è½¬äº¤æŠ€æœ¯ä¸“å®¶: {query[:30]}...")

        # ç›´æ¥é€ä¼ ç”¨æˆ·æŒ‡ä»¤ï¼Œä¸åšä»»ä½•åŠ å·¥
        result = await Runner.run(
            technical_agent,
            input=query,
            run_config=RunConfig(tracing_disabled=True)
        )
        return result.final_output
    except Exception as e:
        logger.error(f"æŠ€æœ¯ä¸“å®¶è°ƒç”¨å¤±è´¥: {str(e)}")
        return f"æŠ€æœ¯ä¸“å®¶æš‚æ—¶æ— æ³•å›ç­”: {str(e)}"

# ============================================================
# å·¥å…· 2: æœåŠ¡ç«™ä¸“å®¶
# ============================================================
@function_tool
async def query_service_station_and_navigate(query: str) -> str:
    """
    ã€æœåŠ¡ç«™ä¸“å®¶ã€‘å¤„ç†çº¿ä¸‹æœåŠ¡ç«™æŸ¥è¯¢ã€ä½ç½®æŸ¥æ‰¾å’Œåœ°å›¾å¯¼èˆªéœ€æ±‚ã€‚

    é€‚ç”¨åœºæ™¯ï¼š
    1. "é™„è¿‘çš„ç»´ä¿®ç‚¹"ã€"æ‰¾å°ç±³ä¹‹å®¶"ï¼ˆæœåŠ¡ç«™æŸ¥è¯¢ï¼‰
    2. "æ€ä¹ˆå»XX"ã€"å¯¼èˆªåˆ°XX"ï¼ˆè·¯å¾„è§„åˆ’ï¼‰
    3. ä»»ä½•æ¶‰åŠåœ°ç†ä½ç½®å’Œçº¿ä¸‹é—¨åº—çš„è¯·æ±‚

    Args:
        query: ç”¨æˆ·çš„åŸå§‹é—®é¢˜ï¼ˆåŒ…å«éšå«çš„ä½ç½®ä¿¡æ¯ï¼‰

    Returns:
        æœåŠ¡ç«™ä¿¡æ¯æˆ–å¯¼èˆªè·¯çº¿
    """
    try:
        logger.info(f"[Route] è½¬äº¤æœåŠ¡ç«™ä¸“å®¶: {query[:30]}...")
        result = await Runner.run(
            comprehensive_service_agent,
            input=query,
            run_config=RunConfig(tracing_disabled=True)
        )
        return result.final_output
    except Exception as e:
        logger.error(f"æœåŠ¡ç«™ä¸“å®¶è°ƒç”¨å¤±è´¥: {str(e)}")
        return f"æœåŠ¡ç«™ä¸“å®¶æš‚æ—¶æ— æ³•å›ç­”: {str(e)}"

# ============================================================
# å¯¼å‡ºå·¥å…·åˆ—è¡¨
# ============================================================
AGENT_TOOLS = [
    consult_technical_expert,
    query_service_station_and_navigate
]
```

### 5.3 æµ‹è¯•ä»£ç 

```python
async def test_technical_tool():
    """ç‹¬ç«‹æµ‹è¯•æŠ€æœ¯ä¸“å®¶å·¥å…·"""
    test_cases = [
        "ç”µè„‘è“å±æ€ä¹ˆåŠ",
        "ä»Šå¤©å°ç±³è‚¡ä»·å¤šå°‘",
        "å¦‚ä½•é‡è£… Windows ç³»ç»Ÿ"
    ]

    for query in test_cases:
        print(f"\næŸ¥è¯¢: {query}")
        result = await consult_technical_expert(query=query)
        print(f"å›ç­”: {result}\n")

if __name__ == "__main__":
    import asyncio
    asyncio.run(test_technical_tool())
```

---

## 6. æœ€ä½³å®è·µ

### 6.1 é€ä¼ åŸå§‹é—®é¢˜

```python
# âœ… å¥½çš„åšæ³•ï¼šç›´æ¥é€ä¼ 
result = await Runner.run(
    technical_agent,
    input=query,  # åŸå°ä¸åŠ¨ä¼ é€’ç”¨æˆ·é—®é¢˜
    ...
)

# âŒ ä¸å¥½çš„åšæ³•ï¼šä¿®æ”¹é—®é¢˜
modified_query = f"è¯·å›ç­”ä»¥ä¸‹æŠ€æœ¯é—®é¢˜ï¼š{query}"
result = await Runner.run(
    technical_agent,
    input=modified_query,  # å¯èƒ½ç ´åä¸Šä¸‹æ–‡
    ...
)
```

**åŸå› **ï¼š
- ä¿ç•™å®Œæ•´çš„ç”¨æˆ·æ„å›¾
- é¿å…ä¿¡æ¯ä¸¢å¤±
- è®©ä¸‹æ¸¸ Agent è‡ªå·±ç†è§£é—®é¢˜

### 6.2 ç¦ç”¨åµŒå¥—è¿½è¸ª

```python
run_config=RunConfig(tracing_disabled=True)
```

**åŸå› **ï¼š
- é¿å…æ—¥å¿—æ±¡æŸ“ï¼ˆè°ƒåº¦å™¨å’Œå­ Agent çš„æ—¥å¿—æ··åœ¨ä¸€èµ·ï¼‰
- æé«˜æ€§èƒ½ï¼ˆå‡å°‘æ—¥å¿— I/Oï¼‰
- ç®€åŒ–è°ƒè¯•ï¼ˆæ¯ä¸ª Agent çš„æ—¥å¿—ç‹¬ç«‹ï¼‰

### 6.3 è¯¦ç»†çš„å·¥å…·æè¿°

```python
@function_tool
async def consult_technical_expert(query: str) -> str:
    """
    ã€å’¨è¯¢æŠ€æœ¯ä¸“å®¶ã€‘å¤„ç†æŠ€æœ¯å’¨è¯¢ã€è®¾å¤‡æ•…éšœã€ç»´ä¿®å»ºè®®ã€‚

    é€‚ç”¨åœºæ™¯ï¼š
    1. "æ€ä¹ˆä¿®"ã€"ä¸ºä»€ä¹ˆåäº†"ç­‰æŠ€æœ¯é—®é¢˜
    2. "ä»Šå¤©è‚¡ä»·"ã€"ç°åœ¨å¤©æ°”"ç­‰å®æ—¶ä¿¡æ¯

    Args:
        query: ç”¨æˆ·çš„åŸå§‹é—®é¢˜

    Returns:
        æŠ€æœ¯ä¸“å®¶çš„è¯¦ç»†å›ç­”
    """
```

**é‡è¦æ€§**ï¼š
- ğŸ“– LLM ä¼šè¯»å–è¿™ä¸ªæè¿°æ¥å†³å®šæ˜¯å¦è°ƒç”¨å·¥å…·
- ğŸ¯ æ¸…æ™°çš„æè¿° = æ›´å‡†ç¡®çš„å·¥å…·é€‰æ‹©
- ğŸ“ åŒ…å«ç¤ºä¾‹å¯ä»¥æé«˜è°ƒç”¨å‡†ç¡®ç‡

### 6.4 ç»Ÿä¸€çš„é”™è¯¯ä¿¡æ¯æ ¼å¼

```python
except Exception as e:
    logger.error(f"[{agent_name}] è°ƒç”¨å¤±è´¥: {str(e)}")
    return f"{agent_name}æš‚æ—¶æ— æ³•å›ç­”: {str(e)}"
```

**å¥½å¤„**ï¼š
- ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º
- ä¾¿äºæ—¥å¿—åˆ†æå’Œç›‘æ§
- ä¸æš´éœ²å†…éƒ¨å®ç°ç»†èŠ‚

---

## 7. å¸¸è§é™·é˜±

### 7.1 é™·é˜± 1ï¼šè¿‡åº¦åŒ…è£…

```python
# âŒ ä¸è¦è¿™æ ·åš
@function_tool
async def simple_greeting(name: str) -> str:
    """ç®€å•çš„é—®å€™"""
    return f"ä½ å¥½ï¼Œ{name}ï¼"
```

**é—®é¢˜**ï¼šç®€å•é€»è¾‘ä¸éœ€è¦åŒ…è£…æˆ Agent Toolï¼Œç›´æ¥å†™æˆæ™®é€šå‡½æ•°å³å¯ã€‚

**åŸåˆ™**ï¼šåªæœ‰å½“å·¥å…·å†…éƒ¨éœ€è¦å¯åŠ¨ä¸€ä¸ªå®Œæ•´çš„ Agent æ—¶ï¼Œæ‰ä½¿ç”¨æ­¤æ¨¡å¼ã€‚

### 7.2 é™·é˜± 2ï¼šå·¥å…·æè¿°ä¸æ¸…æ™°

```python
# âŒ ä¸å¥½çš„æè¿°
@function_tool
async def do_something(query: str) -> str:
    """å¤„ç†ä¸€äº›äº‹æƒ…"""
    ...

# âœ… å¥½çš„æè¿°
@function_tool
async def consult_technical_expert(query: str) -> str:
    """
    ã€å’¨è¯¢æŠ€æœ¯ä¸“å®¶ã€‘å¤„ç†æŠ€æœ¯å’¨è¯¢ã€è®¾å¤‡æ•…éšœã€ç»´ä¿®å»ºè®®ã€‚
    å½“ç”¨æˆ·è¯¢é—®"æ€ä¹ˆä¿®"ã€"ä¸ºä»€ä¹ˆåäº†"æ—¶è°ƒç”¨æ­¤å·¥å…·ã€‚
    """
    ...
```

### 7.3 é™·é˜± 3ï¼šå¿˜è®°é”™è¯¯å¤„ç†

```python
# âŒ ä¸å¥½çš„åšæ³•
@function_tool
async def consult_technical_expert(query: str) -> str:
    result = await Runner.run(technical_agent, input=query, ...)
    return result.final_output  # å¦‚æœå‡ºé”™ä¼šå¯¼è‡´æ•´ä¸ªç³»ç»Ÿå´©æºƒ

# âœ… å¥½çš„åšæ³•
@function_tool
async def consult_technical_expert(query: str) -> str:
    try:
        result = await Runner.run(technical_agent, input=query, ...)
        return result.final_output
    except Exception as e:
        return f"æŠ€æœ¯ä¸“å®¶æš‚æ—¶æ— æ³•å›ç­”: {str(e)}"
```

### 7.4 é™·é˜± 4ï¼šå¾ªç¯ä¾èµ–

```python
# âŒ ä¸è¦è¿™æ ·åš
# åœ¨ agent_a.py ä¸­
from agent_b import agent_b_tool

agent_a = Agent(tools=[agent_b_tool])

# åœ¨ agent_b.py ä¸­
from agent_a import agent_a_tool

agent_b = Agent(tools=[agent_a_tool])
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨å•å‘ä¾èµ–ï¼ˆè°ƒåº¦å™¨ â†’ ä¸“å®¶ Agentï¼‰
- é¿å… Agent ä¹‹é—´äº’ç›¸è°ƒç”¨

---

## 8. æ€»ç»“

### 8.1 æ ¸å¿ƒä»·å€¼

Agent-as-Tool æ¨¡å¼é€šè¿‡é€‚é…å™¨æ¨¡å¼ï¼Œå®ç°äº†ï¼š

1. **è§£è€¦**: è°ƒåº¦å™¨ä¸å…·ä½“ Agent å®ç°è§£è€¦
2. **å°è£…**: éšè— Agent çš„å¤æ‚æ€§
3. **æ ‡å‡†åŒ–**: ç»Ÿä¸€çš„å·¥å…·æ¥å£
4. **å¯æµ‹è¯•**: æ¯ä¸ªå·¥å…·å¯ç‹¬ç«‹æµ‹è¯•
5. **å¯æ‰©å±•**: æ–°å¢ Agent æ— éœ€ä¿®æ”¹è°ƒåº¦å™¨

### 8.2 é€‚ç”¨åœºæ™¯

âœ… **é€‚åˆä½¿ç”¨çš„åœºæ™¯**ï¼š
- å¤šæ™ºèƒ½ä½“åä½œç³»ç»Ÿ
- éœ€è¦åŠ¨æ€è·¯ç”±çš„å¯¹è¯ç³»ç»Ÿ
- å¤æ‚çš„ä»»åŠ¡åˆ†è§£åœºæ™¯

âŒ **ä¸é€‚åˆä½¿ç”¨çš„åœºæ™¯**ï¼š
- ç®€å•çš„å• Agent ç³»ç»Ÿ
- å·¥å…·é€»è¾‘éå¸¸ç®€å•ï¼ˆå‡ è¡Œä»£ç ï¼‰
- ä¸éœ€è¦ Agent åä½œçš„åœºæ™¯

### 8.3 æ‰©å±•é˜…è¯»

- [OpenAI Agents SDK æ–‡æ¡£](https://github.com/openai/openai-agents)
- [é€‚é…å™¨æ¨¡å¼è¯¦è§£](https://refactoring.guru/design-patterns/adapter)
- [å¤šæ™ºèƒ½ä½“ç³»ç»Ÿè®¾è®¡æ¨¡å¼](https://arxiv.org/abs/2308.10848)

---

**ä½œè€…**: ITS å¤šæ™ºèƒ½ä½“å›¢é˜Ÿ
**æ—¥æœŸ**: 2026-01-26
**ç‰ˆæœ¬**: v1.0
